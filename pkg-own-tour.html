<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ayubowan Tours - Create Your Tour</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f4f6f8;
            padding: 20px;
        }

        h2,
        h3 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 20px;
        }

        /* Flex layout for boxes + traveler info */
        .flex-container {
            display: flex;
            gap: 20px;
            justify-content: center;
            align-items: stretch;
            flex-wrap: wrap;
        }

        /* Drag & Drop Boxes */
        .box-dragging {
            flex: 1 1 300px;
            max-width: 400px;
            background: #fff;
            border: 2px dashed #bbb;
            border-radius: 10px;
            padding: 15px;
            position: relative;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
        }

        .box-dragging.drag-over {
            background: #eaf5ff;
            border-color: #3498db;
        }

        /* Items Grid: 2 columns */
        .box-dragging .items-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        /* Individual Item with subtle gradient */
        .item {
            cursor: grab;
            border: 1px solid #ccc;
            border-radius: 8px;
            overflow: hidden;
            text-align: center;
            background: linear-gradient(135deg, #ffffff, #f0f4ff);
            transition: 0.3s;
            padding: 5px;
        }

        .item:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
            background: linear-gradient(135deg, #e0e7ff, #d0e0ff);
        }

        .item img {
            width: 100%;
            height: 100px;
            object-fit: cover;
            border-radius: 5px;
        }

        /* Right Box Background */
        #rightBox {
            /*background-image: url('img/drag-and-box-icon.svg');*/
            background-repeat: no-repeat;
            background-position: center;
            background-size: 120px;
        }

        #rightBox.has-items {
            background-image: none;
        }

        /* Drop Pulse */
        .drop-pulse {
            position: absolute;
            top: 30%;
            /* moved up to avoid overlap */
            left: 0;
            right: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            pointer-events: none;
        }

        .drop-pulse span {
            font-size: 20px;
            font-weight: bold;
            color: #3498db;
            opacity: 0.6;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 0.4;
            }

            50% {
                transform: scale(1.1);
                opacity: 0.8;
            }

            100% {
                transform: scale(1);
                opacity: 0.4;
            }
        }

        /* Traveler Info Box aligned with drag & drop boxes */
        .traveler-info {
            flex: 1 1 300px;
            max-width: 400px;
            background: #fff;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
        }

        /* Stylish Mini Preview Cards with gradient */
        #miniPreview {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 15px;
            max-height: 300px;
            overflow-y: auto;
        }

        .preview-card {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            border-radius: 8px;
            font-weight: 500;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            color: #fff;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .preview-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 20px rgba(0, 0, 0, 0.25), 0 0 15px rgba(255, 255, 255, 0.2);
        }

        .preview-card span.number {
            background: rgba(255, 255, 255, 0.3);
            color: #fff;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-size: 14px;
        }

        .preview-card span.icon {
            margin-right: 10px;
            font-size: 18px;
            color: #fff;
        }

        /* Buttons */
        button {
            margin-top: 10px;
        }

        .text-center button {
            margin: 5px;
        }

        /* WhatsApp Floating Button */
        .whatsapp-float {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 70px;
            height: 70px;
            background: #25D366;
            color: #fff;
            border-radius: 50%;
            font-size: 36px;
            text-align: center;
            line-height: 70px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.35);
            text-decoration: none;
            animation: whatsapp-pulse 1.8s infinite;
        }

        @keyframes whatsapp-pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(37, 211, 102, 0.7);
            }

            70% {
                box-shadow: 0 0 0 25px rgba(37, 211, 102, 0);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(37, 211, 102, 0);
            }
        }

        /* Responsive */
        @media(max-width:1200px) {
            .flex-container {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>

<body>

    <h2>Create Your Own Tour</h2>

    <div class="flex-container mb-4">
        <!-- Available Places -->
        <div class="box-dragging" id="leftBox">
            <h3>Available Places</h3>
            <div class="items-grid" id="availableGrid">
                <div class="item" data-id="Kandy"><img src="img/kandy-package-card.jpeg" alt="">
                    <div>Kandy</div>
                </div>
                <div class="item" data-id="Sigiriya"><img src="img/kandy-dambulla-sirigiya-package-card.jpg" alt="">
                    <div>Dambulla & Sigiriya</div>
                </div>
                <div class="item" data-id="Ella"><img src="img/14-day-tour-srilanka-ella.jpg" alt="">
                    <div>Ella</div>
                </div>
                <div class="item" data-id="Yala"><img src="img/14-day-tour-srilanka-yala.jpg" alt="">
                    <div>Yala Safari</div>
                </div>
            </div>
        </div>

        <!-- Selected Places -->
        <div class="box-dragging" id="rightBox">
            <h3>Selected Places</h3>
            <div class="drop-pulse"><span>Drop Here</span></div>
            <div class="items-grid" id="selectedGrid"></div>
        </div>

        <!-- Traveler Info / Booking Form -->
        <div class="traveler-info">
            <h3 class="text-center mb-3">Traveler Information & Booking</h3>
            <div class="row g-3">
                <div class="col-12"><input type="text" id="name" class="form-control" placeholder="Name"></div>
                <div class="col-12"><input type="email" id="email" class="form-control" placeholder="Email"></div>
                <div class="col-12"><input type="number" id="travelers" class="form-control"
                        placeholder="Number of Travelers" value="1" min="1"></div>
                <div class="col-12"><input type="text" id="phone" class="form-control" placeholder="Phone Number"></div>
                <div class="col-12"><input type="text" id="notes" class="form-control" placeholder="Additional Notes">
                </div>
            </div>

            <!-- Stylish Mini Preview -->
            <div id="miniPreview"><em>No places selected yet</em></div>

            <div class="mt-3 text-center">
                <button id="sendWhatsApp" class="btn btn-success me-2">Send via WhatsApp</button>
                <button id="sendEmail" class="btn btn-primary">Send via Email</button>
                <button id="clearBtn" class="btn btn-secondary mt-2">Clear All</button>
            </div>
        </div>
    </div>

    <a href="#" class="whatsapp-float" id="waFloat" target="_blank">üí¨</a>

    <script>
        // Drag & Drop
        let draggedItem = null;
        document.querySelectorAll('.item').forEach(item => {
            item.draggable = true;
            item.addEventListener('dragstart', () => { draggedItem = item; item.classList.add('dragging'); });
            item.addEventListener('dragend', () => { item.classList.remove('dragging'); draggedItem = null; });
        });

        const availableGrid = document.getElementById('availableGrid');
        const selectedGrid = document.getElementById('selectedGrid');
        const dropPulse = document.querySelector('#rightBox .drop-pulse');

        // Helper: Move item between grids
        function moveItem(item, targetGrid) {
            targetGrid.appendChild(item);
            updatePulse();
            updateMiniPreview();
            saveToLocal();
        }

        // Enable drag & drop for both grids
        [availableGrid, selectedGrid].forEach(grid => {
            grid.parentElement.addEventListener('dragover', e => { e.preventDefault(); grid.parentElement.classList.add('drag-over'); });
            grid.parentElement.addEventListener('dragleave', () => { grid.parentElement.classList.remove('drag-over'); });
            grid.parentElement.addEventListener('drop', e => {
                e.preventDefault();
                grid.parentElement.classList.remove('drag-over');
                if (!draggedItem) return;
                if (grid.contains(draggedItem)) return; // Already here
                moveItem(draggedItem, grid);
            });
        });

        // Show/hide dropPulse
        function updatePulse() {
            dropPulse.style.display = selectedGrid.children.length > 0 ? 'none' : 'flex';
        }

        // Gradient colors for mini-preview cards
        const gradientColors = [
            'linear-gradient(90deg,#6a11cb,#2575fc)',
            'linear-gradient(90deg,#ff512f,#f09819)',
            'linear-gradient(90deg,#43e97b,#38f9d7)',
            'linear-gradient(90deg,#ffafbd,#ffc3a0)',
            'linear-gradient(90deg,#2193b0,#6dd5ed)',
            'linear-gradient(90deg,#ee9ca7,#ffdde1)'
        ];

        // Update Stylish Mini Preview
        function updateMiniPreview() {
            const preview = document.getElementById('miniPreview');
            const items = Array.from(selectedGrid.children).map(i => i.dataset.id);
            if (items.length === 0) { preview.innerHTML = '<em>No places selected yet</em>'; return; }
            preview.innerHTML = '';
            items.forEach((place, i) => {
                const card = document.createElement('div');
                card.className = 'preview-card';
                card.style.background = gradientColors[i % gradientColors.length];
                card.innerHTML = `<span class="number">${i + 1}</span><span class="icon">üìç</span>${place}`;
                preview.appendChild(card);
            });
        }

        // LocalStorage
        function saveToLocal() {
            const selected = Array.from(selectedGrid.children).map(i => i.dataset.id);
            localStorage.setItem('selectedPlaces', JSON.stringify(selected));
        }
        window.onload = function () {
            const stored = JSON.parse(localStorage.getItem('selectedPlaces') || '[]');
            stored.forEach(id => {
                const item = document.querySelector(`#availableGrid .item[data-id="${id}"]`);
                if (item) selectedGrid.appendChild(item);
            });
            updatePulse();
            updateMiniPreview();
        }

        // Clear All
        document.getElementById('clearBtn').onclick = function () {
            Array.from(selectedGrid.children).forEach(i => availableGrid.appendChild(i));
            updatePulse();
            updateMiniPreview();
            localStorage.removeItem('selectedPlaces');
            document.getElementById('name').value = '';
            document.getElementById('email').value = '';
            document.getElementById('phone').value = '';
            document.getElementById('travelers').value = 1;
            document.getElementById('notes').value = '';
        }

        // Format itinerary as numbered list
        function formatItinerary(items) { return items.map((p, i) => `${i + 1}. ${p}`).join('\n'); }

        // WhatsApp Booking
        document.getElementById('sendWhatsApp').onclick = function () {
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const phone = document.getElementById('phone').value;
            const travelers = document.getElementById('travelers').value;
            const notes = document.getElementById('notes').value;
            const itinerary = Array.from(selectedGrid.children).map(i => i.dataset.id);

            if (!name || !phone || itinerary.length === 0) { alert('Please fill name, phone and select places.'); return; }

            const waText = `Ayubowan Tours Booking:
Name: ${name}
Email: ${email}
Phone: ${phone}
Travelers: ${travelers}
Selected Places:
${formatItinerary(itinerary)}
Notes: ${notes}`;

            window.open(`https://wa.me/94763661600?text=${encodeURIComponent(waText)}`, '_blank');
        }

        // Email Booking
        document.getElementById('sendEmail').onclick = function () {
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const phone = document.getElementById('phone').value;
            const travelers = document.getElementById('travelers').value;
            const notes = document.getElementById('notes').value;
            const itinerary = Array.from(selectedGrid.children).map(i => i.dataset.id);

            if (!name || !email || itinerary.length === 0) { alert('Please fill name, email and select places.'); return; }

            const subject = `Ayubowan Tours Booking - ${name}`;
            const body = `Name: ${name}
Email: ${email}
Phone: ${phone}
Travelers: ${travelers}
Selected Places:
${formatItinerary(itinerary)}
Notes: ${notes}`;

            window.location.href = `mailto:info@ayubowantours.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
        }
    </script>
</body>

</html>